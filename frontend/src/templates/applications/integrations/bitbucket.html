<ng-include src="'templates/loader.html'" ng-if="integrations.loading.application || integration.loading.integration"></ng-include>

<div class="panel panel-default" ng-show="!integrations.loading.application && !integration.loading.integration">
    <div class="panel-heading" ng-include="'templates/applications/breadcrumbs.html'"></div>
    <div class="panel-body">

        <h1>Bitbucket Integration</h1>

        <form name="integration.integrationForm" ng-submit="integration.configureIntegration()" class="form-horizontal">
            <div class="form-group">

                <label class="control-label col-sm-3 col-lg-2">Repository</label>

                <div class="col-sm-8 col-lg-9">

                    <data-form-errors errors="integration.integrationForm.ae_validation.user_name"></data-form-errors>
                    <data-form-errors errors="integration.integrationForm.ae_validation.repo_name"></data-form-errors>

                    <div class="input-group">
                        <div class="input-group-addon">https://bitbucket.org/</div>
                        <input class="form-control" ng-model="integration.config.user_name" placeholder="user" type="text">
                        <div class="input-group-addon">/</div>
                        <input class="form-control" ng-model="integration.config.repo_name" placeholder="repo_name" type="text">
                    </div>

                </div>
            </div>
            <div class="form-group">

                <label class="control-label col-sm-3 col-lg-2"></label>

                <div class="col-sm-8 col-lg-9">
                    <input type="submit" class="btn btn-primary" value="Use this repo">
                        <span class="dropdown" data-uib-dropdown on-toggle="toggled(open)">
                            <a class="btn btn-danger" data-uib-dropdown-toggle><span class="fa fa-trash-o"></span> Remove Integration</a>
                          <ul class="dropdown-menu">
                              <li><a>No</a></li>
                              <li><a ng-click="integration.removeIntegration()">Yes</a></li>
                          </ul>
                        </span>
                </div>
            </div>
        </form>

        <p class="m-t-1">Remember you first need to
            <strong>
                <a data-ui-sref="user.profile.identities">authorize your user account</a></strong>
            with Bitbucket before we can send issues on your behalf.</p>

        <p>Every user will have to authorize AppEnlight to access Bitbucket to be able to post issues.</p>

    </div>
</div>
